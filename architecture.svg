<svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-size="24" font-weight="bold">Chinese Theorem Prover Architecture</text>
  
  <!-- MCP Server Layer -->
  <rect x="50" y="60" width="700" height="80" fill="#e8f4f8" stroke="#2196F3" stroke-width="2"/>
  <text x="400" y="90" text-anchor="middle" font-size="18" font-weight="bold">MCP Server Layer</text>
  <text x="400" y="115" text-anchor="middle" font-size="14">Provides tool interface for LLMs with detailed descriptions</text>
  
  <!-- Core Components -->
  <g transform="translate(50, 170)">
    <!-- ProofSession -->
    <rect x="0" y="0" width="200" height="120" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="5"/>
    <text x="100" y="25" text-anchor="middle" font-size="16" font-weight="bold">ProofSession</text>
    <text x="100" y="45" text-anchor="middle" font-size="12">• Manages frames</text>
    <text x="100" y="60" text-anchor="middle" font-size="12">• Records history</text>
    <text x="100" y="75" text-anchor="middle" font-size="12">• Serializes proofs</text>
    <text x="100" y="90" text-anchor="middle" font-size="12">• Global context</text>
    
    <!-- Prover -->
    <rect x="250" y="0" width="200" height="120" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
    <text x="350" y="25" text-anchor="middle" font-size="16" font-weight="bold">Prover</text>
    <text x="350" y="45" text-anchor="middle" font-size="12">• Executes commands</text>
    <text x="350" y="60" text-anchor="middle" font-size="12">• Validates proofs</text>
    <text x="350" y="75" text-anchor="middle" font-size="12">• Algebraic simplification</text>
    <text x="350" y="90" text-anchor="middle" font-size="12">• Pattern matching</text>
    
    <!-- Context -->
    <rect x="500" y="0" width="200" height="120" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
    <text x="600" y="25" text-anchor="middle" font-size="16" font-weight="bold">Context</text>
    <text x="600" y="45" text-anchor="middle" font-size="12">• Stores facts</text>
    <text x="600" y="60" text-anchor="middle" font-size="12">• Named assertions</text>
    <text x="600" y="75" text-anchor="middle" font-size="12">• Inheritance chain</text>
    <text x="600" y="90" text-anchor="middle" font-size="12">• Fact lookup</text>
  </g>
  
  <!-- Commands Section -->
  <text x="400" y="330" text-anchor="middle" font-size="18" font-weight="bold">Chinese Commands</text>
  
  <g transform="translate(50, 350)">
    <!-- Command boxes -->
    <rect x="0" y="0" width="110" height="60" fill="#ffebee" stroke="#f44336" stroke-width="1" rx="3"/>
    <text x="55" y="20" text-anchor="middle" font-size="14" font-weight="bold">不利 (bùlì)</text>
    <text x="55" y="35" text-anchor="middle" font-size="11">Prove</text>
    <text x="55" y="48" text-anchor="middle" font-size="11">non-zero</text>
    
    <rect x="120" y="0" width="110" height="60" fill="#e3f2fd" stroke="#2196f3" stroke-width="1" rx="3"/>
    <text x="175" y="20" text-anchor="middle" font-size="14" font-weight="bold">多能 (duōnéng)</text>
    <text x="175" y="35" text-anchor="middle" font-size="11">Algebraic</text>
    <text x="175" y="48" text-anchor="middle" font-size="11">simplify</text>
    
    <rect x="240" y="0" width="110" height="60" fill="#fce4ec" stroke="#e91e63" stroke-width="1" rx="3"/>
    <text x="295" y="20" text-anchor="middle" font-size="14" font-weight="bold">反证 (fǎnzhèng)</text>
    <text x="295" y="35" text-anchor="middle" font-size="11">Proof by</text>
    <text x="295" y="48" text-anchor="middle" font-size="11">contradiction</text>
    
    <rect x="360" y="0" width="110" height="60" fill="#f3e5f5" stroke="#9c27b0" stroke-width="1" rx="3"/>
    <text x="415" y="20" text-anchor="middle" font-size="14" font-weight="bold">再写 (zàixiě)</text>
    <text x="415" y="35" text-anchor="middle" font-size="11">Rewrite</text>
    <text x="415" y="48" text-anchor="middle" font-size="11">substitute</text>
    
    <rect x="480" y="0" width="110" height="60" fill="#fff3e0" stroke="#ff9800" stroke-width="1" rx="3"/>
    <text x="535" y="20" text-anchor="middle" font-size="14" font-weight="bold">重反 (chóngfǎn)</text>
    <text x="535" y="35" text-anchor="middle" font-size="11">Reverse</text>
    <text x="535" y="48" text-anchor="middle" font-size="11">equality</text>
    
    <rect x="600" y="0" width="100" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="1" rx="3"/>
    <text x="650" y="20" text-anchor="middle" font-size="14" font-weight="bold">确定 (quèdìng)</text>
    <text x="650" y="35" text-anchor="middle" font-size="11">Verify</text>
    <text x="650" y="48" text-anchor="middle" font-size="11">constants</text>
  </g>
  
  <!-- Data Flow -->
  <text x="400" y="450" text-anchor="middle" font-size="18" font-weight="bold">Proof Flow</text>
  
  <g transform="translate(100, 470)">
    <!-- Flow diagram -->
    <rect x="0" y="0" width="120" height="40" fill="#e1f5fe" stroke="#0288d1" stroke-width="1" rx="3"/>
    <text x="60" y="25" text-anchor="middle" font-size="12">Create Session</text>
    
    <path d="M 120 20 L 140 20" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <rect x="140" y="0" width="120" height="40" fill="#e1f5fe" stroke="#0288d1" stroke-width="1" rx="3"/>
    <text x="200" y="25" text-anchor="middle" font-size="12">Add Facts</text>
    
    <path d="M 260 20 L 280 20" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <rect x="280" y="0" width="120" height="40" fill="#e1f5fe" stroke="#0288d1" stroke-width="1" rx="3"/>
    <text x="340" y="25" text-anchor="middle" font-size="12">Start Proof (有)</text>
    
    <path d="M 400 20 L 420 20" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <rect x="420" y="0" width="120" height="40" fill="#e1f5fe" stroke="#0288d1" stroke-width="1" rx="3"/>
    <text x="480" y="25" text-anchor="middle" font-size="12">Apply Commands</text>
    
    <path d="M 540 20 L 560 20" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <rect x="560" y="0" width="120" height="40" fill="#c8e6c9" stroke="#4caf50" stroke-width="1" rx="3"/>
    <text x="620" y="25" text-anchor="middle" font-size="12">Finalize</text>
  </g>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
  </defs>
  
  <!-- Legend -->
  <g transform="translate(50, 540)">
    <text x="0" y="0" font-size="12" font-weight="bold">Key Features:</text>
    <text x="0" y="20" font-size="11">• Hierarchical proof frames with nested sub-proofs</text>
    <text x="0" y="35" font-size="11">• Historical command recording for accurate serialization</text>
    <text x="0" y="50" font-size="11">• Pattern-based rewrite rules for algebraic manipulation</text>
    <text x="400" y="20" font-size="11">• Automatic fact propagation through context inheritance</text>
    <text x="400" y="35" font-size="11">• Self-contained proof export with dependency resolution</text>
    <text x="400" y="50" font-size="11">• Support for complex numbers and symbolic computation</text>
  </g>
</svg>
